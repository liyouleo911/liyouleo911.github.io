---
layout: post
title:  "“历史上的今天”奔溃引发的思考"
categories: Misc 
---

由于侵权问题，服务端下架了部分抓取源，导致“历史上的今天“请求到空数组引发客户端大面积奔溃，针对该事件总结反思如下：

### 服务端是不可靠的
虽然在测试的时候每一天至少有几十个历史事件发生，但是难免发生服务器出错，或者各种各样的原因导致数据下发出错，所以**不能对请求到的数据量做任何假设**

### 新技术理解不够充分
Swift中的JSONDecoder在解析数组时，如果碰到空字符串会解析得到空数组而不是返回nil，说明**基本功还不够扎实**

### 慎用客户端缓存
对缓存到客户端的数据要做有效性检测，否则万一缓存了坏数据就会引起无限的奔溃

### 缓存应该有个过期时间
任何数据都有变化的可能，与其过份依赖数据的不变性，不如定期清理过期的缓存

### 认真对待每一行代码
不管是不是着急上功能，还是用户量不多，都要认真对待每一行代码（谁知道后面会不会量上来了）